<nav class="navbar">
  <div class="navbar-content">
    <div class="logo-container relative" (click)="toggleDiscoverMenu()" (clickOutside)="discoverOnClickOutside($event)">
      <img ngSrc="assets/img/icons/logo.svg" alt="App Logo" class="app-icon" height="1481" width="1456"/>

      <!-- Popover Menu for App Icon (Only on Mobile Screens) -->
      <div *ngIf="isDiscoverMenuOpen"
           class="popover-menu absolute left-2 mt-64 max-w-xs rounded-lg shadow-lg border-2 border-gradient-to-r from-purple-500 to-pink-500 mobile-only">
        <div class="menu-section">
          <hr class="border-gray-200"/>
          <!-- Menu Items -->
          <div class="menu-items p-2">
            <a href="/home" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
              <img ngSrc="/assets/img/icons/home.png" alt="Discover Icon" class="w-5 h-5 mr-2" height="512"
                   width="512">
              <span>Home</span>
            </a>
            <a href="/discover" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
              <img ngSrc="/assets/img/icons/discover.png" alt="Discover Icon" class="w-5 h-5 mr-2" height="512"
                   width="512">
              <span>Discover</span>
            </a>
            <a href="/training" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
              <img ngSrc="/assets/img/icons/training.png" alt="Training Icon" class="w-5 h-5 mr-2" height="512"
                   width="512">
              <span>Training</span>
            </a>
            <a href="/games" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
              <img ngSrc="/assets/img/icons/games.png" alt="Games Icon" class="w-5 h-5 mr-2" height="512" width="512">
              <span>Games</span>
            </a>
          </div>
        </div>
      </div>
    </div>
    <!-- Discover, Training, Games links -->
    <div *ngIf="!isMobile" class="section">
      <a href="/discover" class="nav-link ml-8">Discover</a>
    </div>
    <div *ngIf="!isMobile" class="section">
      <a href="/training" class="nav-link ml-8">Training</a>
    </div>
    <div *ngIf="!isMobile" class="section">
      <a href="/games" class="nav-link ml-8">Games</a>
    </div>
    <span class="spacer"></span>
    <div class="nav-actions">
      <div class="lang-dropdown" (clickOutside)="langsOnClickOutside($event)">
        <div class="relative lang-dropdown">
          <button (click)="toggleDropdown()" class="lang-btn text-lg"
                  [ngStyle]="getButtonStyles(selectedLanguage)">
            {{ selectedLanguage }}
          </button>
          <!-- Dropdown Menu (direct continuation of the button) -->

          <div *ngIf="isLanguageDropdownOpen"
               class="dropdown-menu absolute left-0 mt-0 w-full rounded-b-md shadow-lg z-10"
               (keydown)="handleKeydown($event)">
            <div class="py-1">
              <button *ngFor="let lang of filteredLanguages; let i = index"
                      #dropdownItem
                      tabindex="0"
                      [ngStyle]="getButtonStylesDropDown(lang)"
                      [class.focused]="i === focusedIndex"
                      (click)="changeLanguage(lang)"
                      class="lang-option block w-full px-4 py-2 text-center text-sm text-gray-700 hover:bg-pink-100">
                {{ lang }}
              </button>
            </div>
          </div>
        </div>
      </div>
      <button class="btn-notification">
        <img ngSrc="assets/img/icons/bell.svg" alt="Notification Icon" class="notification-icon" height="40"
             width="40"/>
      </button>
      <!-- Navbar User Profile Section -->
      <div class="user-profile relative" (click)="toggleProfilePopover()" (clickOutside)=profileOnClickOutside($event)>
        <div class="profile-circle bg-gradient-to-r from-purple-500 to-pink-500"></div>
        <!-- Popover Menu -->
        <div *ngIf="isProfilePopoverOpen"
             class="popover-menu absolute right-4 mt-64 max-w-xs rounded-lg shadow-lg border-2 border-gradient-to-r from-purple-500 to-pink-500">
          <div class="menu-section">
            <div class="user-details flex items-center">
              <!-- Profile Picture -->
              <div class="profile-circle-small bg-gradient-to-r from-purple-500 to-pink-500 mr-3 flex-shrink-0"></div>
              <!-- User Info -->
              <div class="user-info overflow-hidden">
                <span class="font-semibold truncate block">{{ userInfo?.username || 'Anonymous Learner' }}</span>
                <p class="text-sm text-gray-500 truncate block">{{ userInfo?.email || 'Not logged in' }}</p>
              </div>
            </div>
            <div class="separator"></div>
            <hr class="border-gray-200"/>
            <!-- Menu Items -->
            <div class="menu-items p-2">
              <a href="/settings" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
                <img ngSrc="/assets/img/icons/settings.svg" alt="gear icon" class="w-5 h-5 mr-2" height="40" width="40">
                <span>Settings</span>
              </a>
              <a href="/logout" class="menu-item flex items-center p-2 rounded-md hover:bg-gray-100 transition">
                <img ngSrc="assets/img/icons/logout.svg" alt="logout icon" class="w-5 h-5 mr-2" height="64" width="64">
                <span>Logout</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>
